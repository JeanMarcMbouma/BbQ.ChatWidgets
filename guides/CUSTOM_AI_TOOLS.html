<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Custom AI Tools Guide | BbQ.ChatWidgets </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Custom AI Tools Guide | BbQ.ChatWidgets ">
    
    
      <link rel="shortcut icon" href="../favicon.ico">
      <link rel="stylesheet" href="../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../styles/docfx.css">
      <link rel="stylesheet" href="../styles/main.css">
      <meta property="docfx:navrel" content="../toc.html">
      <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="custom-ai-tools-guide">Custom AI Tools Guide</h1>

<p>While BbQ.ChatWidgets automatically provides tools for managing widgets, you may want to expose additional capabilities to the LLM, such as fetching data from an external API or performing complex calculations. This is done by implementing the <code>IAIToolsProvider</code> interface.</p>
<h2 id="the-iaitoolsprovider-interface">The <code>IAIToolsProvider</code> Interface</h2>
<p>The interface has a single method that returns a list of <code>AITool</code> objects.</p>
<pre><code class="lang-csharp">public interface IAIToolsProvider
{
    IEnumerable&lt;AITool&gt; GetTools();
}
</code></pre>
<h2 id="implementing-a-custom-provider">Implementing a Custom Provider</h2>
<p>You can use the <code>AIFunctionFactory</code> from <code>Microsoft.Extensions.AI</code> to easily create tools from C# methods.</p>
<pre><code class="lang-csharp">using Microsoft.Extensions.AI;

public class MyToolsProvider : IAIToolsProvider
{
    private readonly IWeatherService _weatherService;

    public MyToolsProvider(IWeatherService weatherService)
    {
        _weatherService = weatherService;
    }

    public IEnumerable&lt;AITool&gt; GetTools()
    {
        // Expose a C# method as an AI tool
        yield return AIFunctionFactory.Create(
            (string city) =&gt; _weatherService.GetWeather(city),
            &quot;get_weather&quot;,
            &quot;Gets the current weather for a city&quot;
        );
    }
}
</code></pre>
<h2 id="registering-the-provider">Registering the Provider</h2>
<p>Register your custom provider using the <code>ToolProviderFactory</code> option in <code>AddBbQChatWidgets</code>.</p>
<pre><code class="lang-csharp">builder.Services.AddScoped&lt;IWeatherService, WeatherService&gt;();

builder.Services.AddBbQChatWidgets(options =&gt;
{
    options.ToolProviderFactory = sp =&gt; 
        new MyToolsProvider(sp.GetRequiredService&lt;IWeatherService&gt;());
});
</code></pre>
<h2 id="the-default-provider">The Default Provider</h2>
<p>If you don't provide a custom <code>ToolProviderFactory</code>, the library uses <code>DefaultAIToolsProvider</code>, which includes a <code>retry_tool</code>. This tool is used by the LLM to signal that it needs to retry a previous operation with different parameters.</p>
<p>If you want to <em>keep</em> the default tools while adding your own, you can resolve the <code>DefaultAIToolsProvider</code> (if registered) or simply include the <code>retry_tool</code> in your own provider.</p>
<h2 id="how-the-llm-uses-tools">How the LLM Uses Tools</h2>
<p>When the <code>ChatWidgetService</code> calls the <code>IChatClient</code>, it includes all tools returned by your provider. The LLM can then choose to call these tools as part of its response generation. The <code>ChatWidgetService</code> handles the execution of these tool calls and feeds the results back to the LLM.</p>
<h2 id="best-practices">Best Practices</h2>
<ul>
<li><strong>Provide Clear Descriptions</strong>: The LLM relies on the tool and parameter descriptions to understand when and how to use a tool.</li>
<li><strong>Keep Tools Idempotent</strong>: Ideally, tools should not have side effects that could cause issues if called multiple times (e.g., during a retry).</li>
<li><strong>Handle Errors Gracefully</strong>: Ensure your tool methods handle exceptions and return meaningful error messages that the LLM can understand.</li>
</ul>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/JeanMarcMbouma/BbQ.ChatWidgets/blob/master/docs_src/guides/CUSTOM_AI_TOOLS.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
